{% extends "base.html" %} {% block title %}Home{% endblock %} {% block content
%}

<!-- Header Section -->
<header class="text-center my-5">
  <h1 class="display-3">StudyPal</h1>
  <small>
    <h2>The easiest way to better grades!</h2>
  </small>
  <!-- Combined Search Form -->
  <form action="/search" method="get" class="input-group my-3">
    <!-- University Dropdown -->
    <select class="custom-select" id="university" name="university" onchange="updateSubjects()">
      <option selected>Choose a university...</option>
      {% for university in universities %}
      <option value="{{ university }}">{{ university }}</option>
      {% endfor %}
    </select>

    <!-- Subject Dropdown, initially disabled -->
    <select class="custom-select" id="subject" name="subject" onchange="updateCourses()" disabled>
      <option selected>Choose a subject...</option>
      <!-- Subject options will be populated based on the selected university -->
    </select>

    <!-- Courses Dropdown, initially disabled -->
    <select class="custom-select" id="course" name="course" disabled>
      <option selected>Choose a course...</option>
      <!-- Course options will be populated based on the selected university and subject -->
    </select>

    <!-- Search Input -->
    <input
      type="text"
      class="form-control"
      placeholder="Search for documents, courses, exams..."
      name="query"
    />
    <div class="input-group-append">
      <button class="btn btn-outline-secondary" type="submit">Search</button>
    </div>
  </form>
</header>

<script>
  var universityData = JSON.parse('{{ university_data|safe }}');

  function updateSubjects() {
    var universitySelect = document.getElementById('university');
    var subjectSelect = document.getElementById('subject');
    var selectedUniversity = universitySelect.value;

    // Reset and disable course dropdown
    var courseSelect = document.getElementById('course');
    courseSelect.innerHTML = '<option selected>Choose a course...</option>';
    courseSelect.disabled = true;

    // Enable and populate subject dropdown
    subjectSelect.innerHTML = '<option selected>Choose a subject...</option>';
    subjectSelect.disabled = false;

    // Attempt to find a matching key in universityData, ignoring case and spaces
    var selectedUniversityKey = Object.keys(universityData).find(key => key.toLowerCase() === selectedUniversity.toLowerCase().trim());

    if (selectedUniversityKey && universityData[selectedUniversityKey]) {
    var subjects = universityData[selectedUniversityKey];
    for (var subject in subjects) {
      var option = document.createElement('option');
      option.value = subject;
      option.textContent = subject;
      subjectSelect.appendChild(option);
      }
    }
  }

  function updateCourses() {
    var universitySelect = document.getElementById('university');
    var subjectSelect = document.getElementById('subject');
    var courseSelect = document.getElementById('course');
    var selectedUniversity = universitySelect.value;
    var selectedSubject = subjectSelect.value;

    // Enable and populate course dropdown
    courseSelect.innerHTML = '<option selected>Choose a course...</option>';
    courseSelect.disabled = false;

    var courses = universityData[selectedUniversity][selectedSubject];
    if (courses) {
      courses.forEach(function(course) {
        var option = document.createElement('option');
        option.value = course;
        option.textContent = course;
        courseSelect.appendChild(option);
      });
    }
  }
</script>

<section class="text-center my-5">
  <div class="container">
    <div class="row">
      <!-- Stats Item -->
      <div class="col">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">50+</h5>
            <p class="card-text">University</p>
            <p class="card-text">
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Suscipit
              delectus dignissimos.
            </p>
          </div>
        </div>
      </div>
      <!-- Stats Item -->
      <div class="col">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">450K+</h5>
            <p class="card-text">Students</p>
            <p class="card-text">
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Suscipit
              delectus dignissimos.
            </p>
          </div>
        </div>
      </div>
      <!-- Add more stats items as necessary -->
    </div>
  </div>
</section>

<!-- About Section -->
<section class="my-5">
  <div class="container">
    <h2 class="text-center">ABOUT STUDYPAL</h2>
    <p>
      Lorem, ipsum dolor sit amet consectetur adipisicing elit. Commodi neque
      illum dolore quidem architecto ratione quod perferendis minima cupiditate
      facere a suscipit numquam eligendi molestiae eos esse dolores,
      voluptatibus officiis!
    </p>
    <!-- Add more content about STUDYPAL here -->
  </div>
</section>

{% endblock %}
