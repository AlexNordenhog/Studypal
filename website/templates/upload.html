{% extends "base.html" %} {% block title %}Upload{% endblock %} {% block content
%}
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Upload Document</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<style>
  /* Your CSS styles */
</style>
<body>
  <h1 class="center-align">StudyPal</h1>
  <h1 class="banner center-align">Upload Page</h1>
  <br />
  <div class="input-group mb-3">
    <input
      type="file"
      class="form-control"
      id="inputGroupFile02"
      accept=".pdf,image/*"
      onchange="previewPDF()"
    />
    <label class="file-container input-group-text" for="inputGroupFile02"
      >Upload</label
    >
  </div>

  <div id="previewContainer" class="center-align">
    <iframe
      id="pdfPreview"
      style="display: none; width: 100%; height: 500px"
      frameborder="0"
    ></iframe>
    <img
      id="imagePreview"
      src="#"
      alt="Image preview"
      style="display: none; max-width: 100%; max-height: 500px"
    />
  </div>

  <br />

  <label for="gradeSelect">Enter your grade here: </label>
  <select id="gradeSelect">
    <option value="select">Välj</option>
    <option value="A">A</option>
    <option value="B">B</option>
    <option value="C">C</option>
    <option value="D">D</option>
    <option value="E">E</option>
    <option value="F">F</option>
  </select>
  <br />

  <label for="typeDocument">Enter the type of document: </label>
  <select id="typeDocument">
    <option value="select">Välj</option>
    <option value="Exam">Exam</option>
    <option value="Assignment">Assignment</option>
    <option value="LectureNotes">Lecture Notes</option>
  </select>
  <br />

  <div class="flex-container">
    <label for="courseCode">Enter the course code: </label>
    <textarea
      id="courseCode"
      placeholder="Write your course code here..."
      rows="1"
      cols="20"
    ></textarea>
  </div>

  <div class="flex-container">
    <label for="header">Enter a title: </label>
    <textarea
      id="headerBox"
      placeholder="Write your comment here..."
      rows="1"
      cols="20"
    ></textarea>
  </div>

  <div class="flex-container">
    <label for="courseCode">Enter a comment here: </label>
    <textarea
      id="commentBox"
      placeholder="Write your comment here..."
      rows="3"
      cols="50"
    ></textarea>
  </div>
  <br />
  <button class="submit-container" type="button" id="submitBtn">
    Submit Upload Details
  </button>

  <script>
    $(document).ready(function () {
      $("#submitBtn").click(function () {
        var formData = new FormData();
        formData.append("grade", $("#gradeSelect").val());
        formData.append("documentType", $("#typeDocument").val());
        formData.append("courseCode", $("#courseCode").val());
        formData.append("comment", $("#commentBox").val());
        formData.append("header", $("#headerBox").val());
        formData.append("file", $("#inputGroupFile02")[0].files[0]);
        formData.append("uid", "vIFFzQ6MEBXOdsV7095oLUmnriF2"); // Assuming this is the user ID

        $.ajax({
          type: "POST",
          url: "/upload_document",
          processData: false,
          contentType: false,
          data: formData,
          success: function (response) {
            console.log(response.message);
            // Handle success, e.g., show a success message to the user
          },
          error: function (xhr, status, error) {
            console.error(xhr.responseText);
            // Handle error, e.g., show an error message to the user
          },
        });
      });
    });

    function previewPDF() {
      var file = document.getElementById("inputGroupFile02").files[0];
      var pdfPreview = document.getElementById("pdfPreview");
      var imagePreview = document.getElementById("imagePreview");

      // Hide both elements initially
      pdfPreview.style.display = "none";
      imagePreview.style.display = "none";

      if (file) {
        var blobUrl = URL.createObjectURL(file);

        if (file.type === "application/pdf") {
          // Handle PDF files
          pdfPreview.src = blobUrl;
          pdfPreview.style.display = "block";
        } else if (file.type.match("image.*")) {
          // Handle image files (JPG, PNG, etc.)
          imagePreview.src = blobUrl;
          imagePreview.style.display = "block";
          imagePreview.style.objectFit = "contain"; // Ensure the image is zoomed to fit the box
        }
      }
    }
  </script>
</body>
{% endblock %}
